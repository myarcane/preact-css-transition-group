{"version":3,"sources":["../src/util.js","../src/TransitionChildMapping.js","../src/CSSCore.js","../src/TransitionEvents.js","../src/CSSTransitionGroupChild.js","../src/CSSTransitionGroup.js"],"names":["getKey","vnode","attributes","key","getComponentBase","component","base","onlyChild","children","filterNullChildren","filter","i","find","arr","iter","length","inChildrenByKey","c","inChildren","child","isShownInChildrenByKey","showProp","props","isShownInChildren","mergeChildMappings","prev","next","ret","nextChildrenPending","pendingChildren","forEach","push","hasOwnProperty","concat","addClass","elem","className","classList","add","apply","_elem$classList","split","removeClass","needle","trim","remove","_elem$classList2","elemClass","norm","SPACE","indexOf","replace","addEndEventListener","node","eventListener","endEvents","window","setTimeout","endEvent","addEventListener","removeEndEventListener","removeEventListener","batchUIMutation","fnMutatingUI","requestAnimationFrame","id","cancelAnimationFrame","clearTimeout","RE_CLASS","EVENT_NAME_MAP","testEl","document","createElement","style","animationend","animation","transitionend","transition","baseEventName","baseEvents","styleName","CSSTransitionGroupChild","_Component","flushClassNameQueue","_this","classNameQueue","join","_temp","possibleConstructorReturn","_ret","animationType","finishCallback","timeout","raiseTimeoutConsoleError","this","name","activeClassName","timer","endListener","e","target","_this2","transitionTimeouts","queueClass","type","timeoutType","error","cancelClassNameMutation","stop","componentWillMount","componentWillUnmount","componentWillEnter","done","enter","enterTimeout","componentWillLeave","leave","leaveTimeout","render","Component","CSSTransitionGroup","call","renderChild","transitionName","_this$props","transitionEnter","transitionLeave","transitionEnterTimeout","transitionLeaveTimeout","h","refs","state","slice","shouldComponentUpdate","_","_ref","currentlyTransitioningKeys","keysToEnter","keysToLeave","componentWillReceiveProps","_ref2","exclusive","nextChildMapping","prevChildMapping","newChildren","map","cloneElement","_cloneElement","setState","forceUpdate","hasPrev","showInPrev","showInNow","hasNext","showInNext","performEnter","_this3","_handleDoneEntering","currentChildMapping","performLeave","_this4","_handleDoneLeaving","componentDidUpdate","k","_this5","_ref3","_ref4","objectWithoutProperties","defaultProps"],"mappings":"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","file":"preact-css-transition-group.min.js","sourcesContent":["export function getKey(vnode) {\n\treturn vnode.attributes && vnode.attributes.key;\n}\n\nexport function getComponentBase(component) {\n\treturn component.base;\n}\n\nexport function onlyChild(children) {\n\treturn children && children[0];\n}\n\nexport function filterNullChildren(children) {\n\treturn children && children.filter(i => i !== null);\n}\n\nexport const batchUIMutation = (fnMutatingUI) => {\n\tif (typeof window !== 'undefined' && window.requestAnimationFrame) {\n\t\tconst id = requestAnimationFrame(() => {\n\t\t\tcancelAnimationFrame(id);\n\t\t\tfnMutatingUI();\n\t\t});\n\t\treturn () => cancelAnimationFrame(id);\n\t}\n\n\tconst id = setTimeout(() => {\n\t\tclearTimeout(id);\n\t\tfnMutatingUI();\n\t});\n\treturn () => clearTimeout(id);\n};\n","/**\n * Copyright 2013-2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n *\tAdditional credit to the Author of rc-css-transition-group: https://github.com/yiminghe\n *\tFile originally extracted from the React source, converted to ES6 by https://github.com/developit\n */\n\nimport { getKey } from './util';\n\n\n// look for a needle in a haystack\nfunction find(arr, iter) {\n\tfor (let i=arr.length; i--; ) {\n\t\tif (iter(arr[i])) return true;\n\t}\n\treturn false;\n}\n\n\nexport function inChildrenByKey(children, key) {\n\treturn find(children, c => getKey(c)===key);\n}\n\nexport function inChildren(children, child) {\n\treturn inChildrenByKey(children, getKey(child));\n}\n\n\nexport function isShownInChildrenByKey(children, key, showProp) {\n\treturn find(children, c => (\n\t\tgetKey(c)===key && c.props[showProp]\n\t));\n}\n\nexport function isShownInChildren(children, child, showProp) {\n\treturn isShownInChildrenByKey(children, getKey(child), showProp);\n}\n\n\nexport function mergeChildMappings(prev, next) {\n\tlet ret = [];\n\n\t// For each key of `next`, the list of keys to insert before that key in\n\t// the combined list\n\tlet nextChildrenPending = {},\n\t\tpendingChildren = [];\n\tprev.forEach( c => {\n\t\tlet key = getKey(c);\n\t\tif (inChildrenByKey(next, key)) {\n\t\t\tif (pendingChildren.length) {\n\t\t\t\tnextChildrenPending[key] = pendingChildren;\n\t\t\t\tpendingChildren = [];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tpendingChildren.push(c);\n\t\t}\n\t});\n\n\tnext.forEach( c => {\n\t\tlet key = getKey(c);\n\t\tif (nextChildrenPending.hasOwnProperty(key)) {\n\t\t\tret = ret.concat(nextChildrenPending[key]);\n\t\t}\n\t\tret.push(c);\n\t});\n\n\treturn ret.concat(pendingChildren);\n}\n","/**\n * Copyright 2013-2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n *\tAdditional credit to the Author of rc-css-transition-group: https://github.com/yiminghe\n *\tFile originally extracted from the React source, converted to ES6 by https://github.com/developit\n */\n\n\nconst SPACE = ' ';\nconst RE_CLASS = /[\\n\\t\\r]+/g;\n\nlet norm = elemClass => (SPACE + elemClass + SPACE).replace(RE_CLASS, SPACE);\n\nexport function addClass(elem, className) {\n\tif (elem.classList) {\n\t\telem.classList.add(...className.split(' '));\n\t} else {\n\t\telem.className += ' ' + className;\n\t}\n}\n\nexport function removeClass(elem, needle) {\n\tneedle = needle.trim();\n\tif (elem.classList) {\n\t\telem.classList.remove(...needle.split(' '));\n\t} else {\n\t\tlet elemClass = elem.className.trim();\n\t\tlet className = norm(elemClass);\n\t\tneedle = SPACE + needle + SPACE;\n\t\twhile (className.indexOf(needle) >= 0) {\n\t\t\tclassName = className.replace(needle, SPACE);\n\t\t}\n\t\telem.className = className.trim();\n\t}\n}\n","/**\n * Copyright 2013-2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n *\tAdditional credit to the Author of rc-css-transition-group: https://github.com/yiminghe\n *\tFile originally extracted from the React source, converted to ES6 by https://github.com/developit\n */\n\n\n/**\n * EVENT_NAME_MAP is used to determine which event fired when a\n * transition/animation ends, based on the style property used to\n * define that event.\n */\nconst EVENT_NAME_MAP = {\n\ttransitionend: {\n\t\ttransition: 'transitionend',\n\t\tWebkitTransition: 'webkitTransitionEnd',\n\t\tMozTransition: 'mozTransitionEnd',\n\t\tOTransition: 'oTransitionEnd',\n\t\tmsTransition: 'MSTransitionEnd'\n\t},\n\n\tanimationend: {\n\t\tanimation: 'animationend',\n\t\tWebkitAnimation: 'webkitAnimationEnd',\n\t\tMozAnimation: 'mozAnimationEnd',\n\t\tOAnimation: 'oAnimationEnd',\n\t\tmsAnimation: 'MSAnimationEnd'\n\t}\n};\n\nlet endEvents = [];\n\nfunction detectEvents() {\n\tlet testEl = document.createElement('div'),\n\t\tstyle = testEl.style;\n\n\t// On some platforms, in particular some releases of Android 4.x,\n\t// the un-prefixed \"animation\" and \"transition\" properties are defined on the\n\t// style object but the events that fire will still be prefixed, so we need\n\t// to check if the un-prefixed events are useable, and if not remove them\n\t// from the map\n\tif (!('AnimationEvent' in window)) {\n\t\tdelete EVENT_NAME_MAP.animationend.animation;\n\t}\n\n\tif (!('TransitionEvent' in window)) {\n\t\tdelete EVENT_NAME_MAP.transitionend.transition;\n\t}\n\n\tfor (let baseEventName in EVENT_NAME_MAP) {  // eslint-disable-line guard-for-in\n\t\tlet baseEvents = EVENT_NAME_MAP[baseEventName];\n\t\tfor (let styleName in baseEvents) {\n\t\t\tif (styleName in style) {\n\t\t\t\tendEvents.push(baseEvents[styleName]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nif (typeof window !== 'undefined') {\n\tdetectEvents();\n}\n\nexport { endEvents };\n\nexport function addEndEventListener(node, eventListener) {\n\tif (!endEvents.length) {\n\t\t// If CSS transitions are not supported, trigger an \"end animation\" event immediately.\n\t\treturn window.setTimeout(eventListener, 0);\n\t}\n\tendEvents.forEach( endEvent => {\n\t\tnode.addEventListener(endEvent, eventListener, false);\n\t});\n}\n\nexport function removeEndEventListener(node, eventListener) {\n\tif (!endEvents.length) return;\n\tendEvents.forEach( endEvent => {\n\t\tnode.removeEventListener(endEvent, eventListener, false);\n\t});\n}\n","/**\n * Copyright 2013-2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n *\tAdditional credit to the Author of rc-css-transition-group: https://github.com/yiminghe\n *\tFile originally extracted from the React source, converted to ES6 by https://github.com/developit\n */\n\n\nimport { h, Component } from 'preact';\nimport { getComponentBase, onlyChild, batchUIMutation } from './util';\nimport { addClass, removeClass } from './CSSCore';\nimport { addEndEventListener, removeEndEventListener } from './TransitionEvents';\n\nexport class CSSTransitionGroupChild extends Component {\n\ttransition(animationType, finishCallback, timeout) {\n\n\t\tif (!timeout) {\n\t\t\tthis.raiseTimeoutConsoleError(animationType);\n\t\t}\n\n\t\tlet node = getComponentBase(this);\n\n\t\tlet className = this.props.name[animationType] || this.props.name + '-' + animationType;\n\t\tlet activeClassName = this.props.name[animationType + 'Active'] || className + '-active';\n\t\tlet timer = null;\n\n\t\tif (this.endListener) {\n\t\t\tthis.endListener();\n\t\t}\n\n\t\tthis.endListener = (e) => {\n\t\t\tif (e && e.target!==node) return;\n\n\t\t\tclearTimeout(timer);\n\t\t\tremoveClass(node, className);\n\t\t\tremoveClass(node, activeClassName);\n\t\t\tremoveEndEventListener(node, this.endListener);\n\t\t\tthis.endListener = null;\n\n\t\t\t// Usually this optional callback is used for informing an owner of\n\t\t\t// a leave animation and telling it to remove the child.\n\t\t\tif (finishCallback) {\n\t\t\t\tfinishCallback();\n\t\t\t}\n\t\t};\n\n\t\tif (timeout) {\n\t\t\ttimer = setTimeout(this.endListener, timeout);\n\t\t\tthis.transitionTimeouts.push(timer);\n\t\t} else {\n\t\t\taddEndEventListener(node, this.endListener);\n\t\t}\n\n\t\taddClass(node, className);\n\n\t\t// Need to do this to actually trigger a transition.\n\t\tthis.queueClass(activeClassName);\n\t}\n\n\traiseTimeoutConsoleError(type) {\n\t\tconst timeoutType = type === 'enter' ?  'transitionEnterTimeout' : 'transitionLeaveTimeout';\n\t\tconsole.error(`${timeoutType} should be specified`);\n\t}\n\n\tqueueClass(className) {\n\t\tthis.classNameQueue.push(className);\n\t\tthis.cancelClassNameMutation = batchUIMutation(this.flushClassNameQueue);\n\t}\n\n\tstop() {\n\t\tif (this.cancelClassNameMutation) {\n\t\t\tthis.cancelClassNameMutation();\n\t\t}\n\t\tthis.classNameQueue.length = 0;\n\t\tif (this.endListener) {\n\t\t\tthis.endListener();\n\t\t}\n\t}\n\n\tflushClassNameQueue = () => {\n\t\tif (getComponentBase(this)) {\n\t\t\taddClass(getComponentBase(this), this.classNameQueue.join(' '));\n\t\t}\n\t\tthis.classNameQueue.length = 0;\n\t};\n\n\tcomponentWillMount() {\n\t\tthis.classNameQueue = [];\n\t\tthis.transitionTimeouts = [];\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (this.cancelClassNameMutation) {\n\t\t\tthis.cancelClassNameMutation();\n\t\t}\n\t\tthis.classNameQueue.length = 0;\n\t\tthis.transitionTimeouts.forEach((timeout) => {\n\t\t\tclearTimeout(timeout);\n\t\t});\n\t}\n\n\tcomponentWillEnter(done) {\n\t\tif (this.props.enter) {\n\t\t\tthis.transition('enter', done, this.props.enterTimeout);\n\t\t}\n\t\telse {\n\t\t\tdone();\n\t\t}\n\t}\n\n\tcomponentWillLeave(done) {\n\t\tif (this.props.leave) {\n\t\t\tthis.transition('leave', done, this.props.leaveTimeout);\n\t\t}\n\t\telse {\n\t\t\tdone();\n\t\t}\n\t}\n\n\trender() {\n\t\treturn onlyChild(this.props.children);\n\t}\n}\n","/**\n * Copyright 2013-2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n *\tAdditional credit to the Author of rc-css-transition-group: https://github.com/yiminghe\n *\tFile originally extracted from the React source, converted to ES6 by https://github.com/developit\n */\n\n\nimport { h, cloneElement, Component } from 'preact';\nimport { getKey, filterNullChildren } from './util';\nimport { mergeChildMappings, isShownInChildren, isShownInChildrenByKey, inChildren, inChildrenByKey } from './TransitionChildMapping';\nimport { CSSTransitionGroupChild } from './CSSTransitionGroupChild';\n\nexport class CSSTransitionGroup extends Component {\n\tstatic defaultProps = {\n\t\tcomponent: 'span',\n\t\ttransitionEnter: true,\n\t\ttransitionLeave: true\n\t};\n\n\tconstructor(props) {\n\t\tsuper();\n\t\tthis.refs = {};\n\t\tthis.state = {\n\t\t\tchildren: (props.children || []).slice()\n\t\t};\n\t}\n\n\tshouldComponentUpdate(_, { children }) {\n\t\treturn children!==this.state.children;\n\t}\n\n\tcomponentWillMount() {\n\t\tthis.currentlyTransitioningKeys = {};\n\t\tthis.keysToEnter = [];\n\t\tthis.keysToLeave = [];\n\t}\n\n\tcomponentWillReceiveProps({ children, exclusive, showProp }) {\n\t\tlet nextChildMapping = filterNullChildren(children || []).slice();\n\n\t\t// last props children if exclusive\n\t\tlet prevChildMapping = filterNullChildren(exclusive ? this.props.children : this.state.children);\n\n\t\tlet newChildren = mergeChildMappings(\n\t\t\tprevChildMapping,\n\t\t\tnextChildMapping\n\t\t);\n\n\t\tif (showProp) {\n\t\t\tnewChildren = newChildren.map( c => {\n\t\t\t\tif (!c.props[showProp] && isShownInChildren(prevChildMapping, c, showProp)) {\n\t\t\t\t\tc = cloneElement(c, { [showProp]:true });\n\t\t\t\t}\n\t\t\t\treturn c;\n\t\t\t});\n\t\t}\n\n\t\tif (exclusive) {\n\t\t\t// make middle state children invalid\n\t\t\t// restore to last props children\n\t\t\tnewChildren.forEach( c => this.stop(getKey(c)) );\n\t\t}\n\n\t\tthis.setState({ children: newChildren });\n\t\tthis.forceUpdate();\n\n\t\tnextChildMapping.forEach( c => {\n\t\t\tlet { key } = c,\n\t\t\t\thasPrev = prevChildMapping && inChildren(prevChildMapping, c);\n\t\t\tif (showProp) {\n\t\t\t\tif (hasPrev) {\n\t\t\t\t\tlet showInPrev = isShownInChildren(prevChildMapping, c, showProp),\n\t\t\t\t\t\tshowInNow = c.props[showProp];\n\t\t\t\t\tif (!showInPrev && showInNow && !this.currentlyTransitioningKeys[key]) {\n\t\t\t\t\t\tthis.keysToEnter.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!hasPrev && !this.currentlyTransitioningKeys[key]) {\n\t\t\t\tthis.keysToEnter.push(key);\n\t\t\t}\n\t\t});\n\n\t\tprevChildMapping.forEach( c => {\n\t\t\tlet { key } = c,\n\t\t\t\thasNext = nextChildMapping && inChildren(nextChildMapping, c);\n\t\t\tif (showProp) {\n\t\t\t\tif (hasNext) {\n\t\t\t\t\tlet showInNext = isShownInChildren(nextChildMapping, c, showProp);\n\t\t\t\t\tlet showInNow = c.props[showProp];\n\t\t\t\t\tif (!showInNext && showInNow && !this.currentlyTransitioningKeys[key]) {\n\t\t\t\t\t\tthis.keysToLeave.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!hasNext && !this.currentlyTransitioningKeys[key]) {\n\t\t\t\tthis.keysToLeave.push(key);\n\t\t\t}\n\t\t});\n\t}\n\n\tperformEnter(key) {\n\t\tthis.currentlyTransitioningKeys[key] = true;\n\t\tlet component = this.refs[key];\n\t\tif (component.componentWillEnter) {\n\t\t\tcomponent.componentWillEnter( () => this._handleDoneEntering(key) );\n\t\t}\n\t\telse {\n\t\t\tthis._handleDoneEntering(key);\n\t\t}\n\t}\n\n\t_handleDoneEntering(key) {\n\t\tdelete this.currentlyTransitioningKeys[key];\n\t\tlet currentChildMapping = filterNullChildren(this.props.children),\n\t\t\tshowProp = this.props.showProp;\n\t\tif (!currentChildMapping || (\n\t\t\t!showProp && !inChildrenByKey(currentChildMapping, key)\n\t\t) || (\n\t\t\tshowProp && !isShownInChildrenByKey(currentChildMapping, key, showProp)\n\t\t)) {\n\t\t\t// This was removed before it had fully entered. Remove it.\n\t\t\tthis.performLeave(key);\n\t\t}\n\t\telse {\n\t\t\tthis.setState({ children: currentChildMapping });\n\t\t\t// this.forceUpdate();\n\t\t}\n\t}\n\n\tstop(key) {\n\t\tdelete this.currentlyTransitioningKeys[key];\n\t\tlet component = this.refs[key];\n\t\tif (component) component.stop();\n\t}\n\n\tperformLeave(key) {\n\t\tthis.currentlyTransitioningKeys[key] = true;\n\t\tlet component = this.refs[key];\n\t\tif (component && component.componentWillLeave) {\n\t\t\tcomponent.componentWillLeave( () => this._handleDoneLeaving(key) );\n\t\t}\n\t\telse {\n\t\t\t// Note that this is somewhat dangerous b/c it calls setState()\n\t\t\t// again, effectively mutating the component before all the work\n\t\t\t// is done.\n\t\t\tthis._handleDoneLeaving(key);\n\t\t}\n\t}\n\n\t_handleDoneLeaving(key) {\n\t\tdelete this.currentlyTransitioningKeys[key];\n\t\tlet showProp = this.props.showProp,\n\t\t\tcurrentChildMapping = filterNullChildren(this.props.children);\n\t\tif (showProp && currentChildMapping &&\n\t\t\tisShownInChildrenByKey(currentChildMapping, key, showProp)) {\n\t\t\tthis.performEnter(key);\n\t\t}\n\t\telse if (!showProp && currentChildMapping && inChildrenByKey(currentChildMapping, key)) {\n\t\t\t// This entered again before it fully left. Add it again.\n\t\t\tthis.performEnter(key);\n\t\t}\n\t\telse {\n\t\t\tthis.setState({ children: currentChildMapping });\n\t\t\t// this.forceUpdate();\n\t\t}\n\t}\n\n\tcomponentDidUpdate() {\n\t\tlet { keysToEnter, keysToLeave } = this;\n\t\tthis.keysToEnter = [];\n\t\tkeysToEnter.forEach( k => this.performEnter(k) );\n\t\tthis.keysToLeave = [];\n\t\tkeysToLeave.forEach( k => this.performLeave(k) );\n\t}\n\n\trenderChild = child => {\n\t\tlet { transitionName, transitionEnter, transitionLeave, transitionEnterTimeout, transitionLeaveTimeout } = this.props,\n\t\t\tkey = getKey(child);\n\t\treturn (\n\t\t\t<CSSTransitionGroupChild\n\t\t\t\tkey={key}\n\t\t\t\tref={ c => {\n\t\t\t\t\tif (!(this.refs[key] = c)) child = null;\n\t\t\t\t}}\n\t\t\t\tname={transitionName}\n\t\t\t\tenter={transitionEnter}\n\t\t\t\tleave={transitionLeave}\n\t\t\t\tenterTimeout={transitionEnterTimeout}\n\t\t\t\tleaveTimeout={transitionLeaveTimeout}>\n\t\t\t\t{child}\n\t\t\t</CSSTransitionGroupChild>\n\t\t);\n\t};\n\n\trender({ component:Component, transitionName, transitionEnter, transitionLeave, transitionEnterTimeout, transitionLeaveTimeout, children:c, ...props }, { children }) {\n\t\treturn (\n\t\t\t<Component {...props}>\n\t\t\t\t{ filterNullChildren(children).map(this.renderChild) }\n\t\t\t</Component>\n\t\t);\n\t}\n}\n"]}